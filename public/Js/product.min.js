let params = new URL(document.location).searchParams,
  id = params.get("id");
const varnishElt = document.getElementById("varnish-select");
console.log("varnishElt:" + varnishElt);
const titleElt = document.getElementById("titre");
console.log("titleElt:" + titleElt);
const priceElt = document.getElementById("prix");
console.log("priceElt:" + priceElt);
const descriptionElt = document.getElementById("description");
console.log("descriptionElt:" + descriptionElt);
const imageElt = document.getElementById("image");
console.log("imageElt:" + imageElt);
const quantityElt = document.getElementById("quantityProduct");
function main() {
  getArticles(), addToBasket();
}
function getArticles() {
  fetch(`http://localhost:3000/api/furniture/${id}`)
    .then(function (t) {
      return t.json();
    })
    .catch((t) => {
      document.getElementById("container").innerHTML =
        "oups! Avez-vous bien lancé le serveur local au Port 3000 ?";
    })
    .then(function (t) {
      (titleElt.textContent = t.name),
        (priceElt.textContent = t.price / 100 + " €"),
        (descriptionElt.textContent = t.description),
        (imageElt.src = t.imageUrl);
      let e = t.varnish;
      console.log("optionVarnish:" + e);
      let n = [];
      for (let t = 0; t < e.length; t++)
        (n += `<option value="${t + 1}">${e[t]}</option>`),
          (varnishElt.innerHTML = n),
          console.log("varnishElt.innerHTML:" + varnishElt.innerHTML);
    });
}
function addToBasket() {
  const t = document.getElementById("add-to-basket");
  console.log("addToBasket:" + t),
    t.addEventListener("click", () => {
      if (
        (alert("Votre article a été ajouté au panier"),
        null != varnishElt && null != quantityElt)
      ) {
        console.log("hello if");
        let t = {
          name: titleElt.textContent,
          price: priceElt.textContent,
          quantity: quantityElt.value,
          _id: id,
        };
        console.log("productAdded:" + t);
        let e = [];
        null !== localStorage.getItem("products") &&
          (e = JSON.parse(localStorage.getItem("products"))),
          e.push(t),
          localStorage.setItem("products", JSON.stringify(e));
      }
    });
}
console.log("quantityElt:" + quantityElt),
  main(),
  console.log("addEventlistener:" + addEventListener);
